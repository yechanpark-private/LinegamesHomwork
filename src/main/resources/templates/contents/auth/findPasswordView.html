<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">
<head>
    <!-- Site Properties -->
    <title>Bootstrap 4 Register Form</title>
</head>
<body>
<div layout:fragment="content">
    <div class="container">
        <div class="kpx_login p-5 my-5">
            <div class="row kpx_row-sm-offset-3">
                <div class="col-xs-12 col-sm-6">
                    <form class="kpx_loginForm" th:action="@{/user/findPassword}" autocomplete="off" method="POST">
                        <div class="input-group">
                            <span class="input-group-addon"><span class="fa fa-user"></span></span>
                            <input id="usernameInput" type="text" class="form-control" name="username"
                                   placeholder="Username">
                            <br>
                            <span style="display:none" id="userFindResultSpan" class="tag tag-danger"></span>
                        </div>

                        <div id="passwordInputGroup" style="display:none" class="input-group">
                            <hr/>
                            <span class="input-group-addon"><span class="fa fa-key"></span></span>
                            <input id="passwordInput" type="text" class="form-control" name="password"
                                   placeholder="Password">
                        </div>


                        <hr/>
                        <a id="findButton" class="btn btn-lg btn-outline-primary btn-block">
                            <i class="fa fa-sign-in"></i>Find</a>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function() {
            $("#findButton").click(function(){
                let usernameInput = $('#usernameInput').val();

                $.ajax({
                    url: '/client/user/rest/' + usernameInput,
                    type: 'get',
                    success: function(result) {

                        // 찾고자 하는 아이디가 존재하는 경우
                        if( !result.errorCode ) {
                            $('#userFindResultSpan').css("color", "green");
                            $('#userFindResultSpan').text("username : '" + result.data.username + "' Confirmed");
                            $('#passwordInputGroup').css("display", "");
                        }

                        // 찾고자 하는 아이디가 존재하지 않는 경우
                        else {
                            $('#userFindResultSpan').css("color", "red");
                            $('#userFindResultSpan').text(result.errorMessage);
                        }

                        $('#userFindResultSpan').css("display", "");

                    },
                    fail: function() {
                        alert('요청에 실패했습니다.');
                    }
                });
            });
        });


    </script>
</div>
</body>
</html>